import{r as l,s as p,j as e,n as S,h as n,z as j}from"./index-Cyx07lUy.js";import{E as _}from"./eye-C3qHwsAR.js";const r=[{value:"aguardando_confirmacao",label:"Aguardando",color:"badge-yellow"},{value:"confirmado",label:"Confirmado",color:"badge-primary"},{value:"em_producao",label:"Em Produção",color:"badge-blue"},{value:"enviado",label:"Enviado",color:"badge-primary"},{value:"entregue",label:"Entregue",color:"badge-green"},{value:"cancelado",label:"Cancelado",color:"badge-red"}];function w(){var m;const[g,f]=l.useState([]),[v,b]=l.useState(!0),[d,y]=l.useState(""),[t,i]=l.useState(null);l.useEffect(()=>{c()},[]);async function c(){const{data:s}=await p.from("orders").select("*").order("created_at",{ascending:!1});f(s||[]),b(!1)}const h=g.filter(s=>!d||s.status===d);async function u(s,a){const{error:o}=await p.from("orders").update({status:a}).eq("id",s);if(o){j.error("Erro ao atualizar");return}j.success("Status atualizado!"),c(),(t==null?void 0:t.id)===s&&i({...t,status:a})}function x(s){const a=r.find(o=>o.value===s);return e.jsx("span",{className:`badge ${(a==null?void 0:a.color)||"badge-gray"}`,children:(a==null?void 0:a.label)||s})}return e.jsxs("div",{children:[e.jsxs("div",{className:"admin-page-header",style:{marginBottom:24},children:[e.jsx("h1",{className:"admin-page-title",style:{margin:0},children:"Pedidos"}),e.jsxs("select",{value:d,onChange:s=>y(s.target.value),style:{minWidth:180},children:[e.jsx("option",{value:"",children:"Todos os status"}),r.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]})]}),v?e.jsx("div",{className:"skeleton",style:{height:300}}):h.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx(S,{size:48}),e.jsx("h3",{children:"Nenhum pedido encontrado"})]}):e.jsx("div",{className:"table-container",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Pedido"}),e.jsx("th",{children:"Cliente"}),e.jsx("th",{children:"Data"}),e.jsx("th",{children:"Total"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Ações"})]})}),e.jsx("tbody",{children:h.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:s.numero_pedido})}),e.jsxs("td",{children:[e.jsx("div",{children:s.customer_name}),e.jsx("div",{style:{fontSize:12,color:"var(--color-text-muted)"},children:s.customer_email})]}),e.jsx("td",{style:{whiteSpace:"nowrap"},children:new Date(s.created_at).toLocaleDateString("pt-BR")}),e.jsx("td",{children:e.jsx("strong",{children:n(s.total)})}),e.jsx("td",{children:x(s.status)}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>i(s),className:"btn btn-sm btn-outline",children:[e.jsx(_,{size:14})," Ver"]}),e.jsx("div",{style:{position:"relative"},children:e.jsx("select",{value:s.status,onChange:a=>u(s.id,a.target.value),style:{padding:"6px 8px",fontSize:12,minWidth:100},children:r.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})})]})})]},s.id))})]})}),t&&e.jsx("div",{className:"category-form-overlay",onClick:()=>i(null),children:e.jsxs("div",{className:"card",style:{maxWidth:600,width:"100%",padding:32,maxHeight:"80vh",overflow:"auto"},onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{children:t.numero_pedido}),x(t.status)]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{style:{fontSize:14,fontWeight:600,marginBottom:8},children:"Cliente"}),e.jsx("p",{style:{fontSize:14},children:t.customer_name}),e.jsxs("p",{style:{fontSize:13,color:"var(--color-text-muted)"},children:[t.customer_email," • ",t.customer_phone]}),e.jsxs("p",{style:{fontSize:13,color:"var(--color-text-muted)"},children:["CPF: ",t.customer_cpf]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{style:{fontSize:14,fontWeight:600,marginBottom:8},children:"Endereço de Entrega"}),t.shipping_address&&e.jsxs("p",{style:{fontSize:13,color:"var(--color-text-muted)"},children:[t.shipping_address.logradouro,", ",t.shipping_address.numero,t.shipping_address.complemento&&` - ${t.shipping_address.complemento}`,e.jsx("br",{}),t.shipping_address.bairro," — ",t.shipping_address.cidade,"/",t.shipping_address.estado,e.jsx("br",{}),"CEP: ",t.shipping_address.cep]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{style:{fontSize:14,fontWeight:600,marginBottom:8},children:"Itens"}),(m=t.items)==null?void 0:m.map((s,a)=>e.jsxs("div",{className:"flex justify-between items-center",style:{padding:"6px 0",borderBottom:"1px solid var(--color-border)"},children:[e.jsxs("span",{style:{fontSize:13},children:[s.quantidade,"x ",s.nome]}),e.jsx("strong",{style:{fontSize:13},children:n(s.preco*s.quantidade)})]},a))]}),e.jsxs("div",{style:{borderTop:"2px solid var(--color-border)",paddingTop:12},children:[e.jsxs("div",{className:"flex justify-between mb-2",style:{fontSize:14},children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{children:n(t.subtotal)})]}),e.jsxs("div",{className:"flex justify-between mb-2",style:{fontSize:14},children:[e.jsxs("span",{children:["Frete (",t.shipping_method,")"]}),e.jsx("span",{children:n(t.shipping_cost)})]}),e.jsxs("div",{className:"flex justify-between",style:{fontSize:18,fontWeight:700},children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:n(t.total)})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-6",children:[e.jsx("select",{value:t.status,onChange:s=>u(t.id,s.target.value),style:{minWidth:160},children:r.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))}),e.jsx("button",{onClick:()=>i(null),className:"btn btn-outline",children:"Fechar"})]})]})})]})}export{w as default};
